from ultralytics import YOLO
import torch

# ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
model_files = [
    "‡πÇ‡∏õ‡πä‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏¢‡∏î‡∏µ‡∏à‡∏±‡∏î‡πÄ‡∏•‡∏µ‡∏¢‡πÜ‡πÜ‡πÜ‡πÜ.pt",
    "‡∏≠‡∏≤‡∏ß‡∏∏‡∏ò‡∏î‡∏µ‡∏à‡∏±‡∏î‡∏õ‡∏±‡πâ‡∏á‡∏á‡∏á‡∏á‡∏á‡πÜ.pt",
    "‡∏ö‡∏∏‡∏´‡∏£‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏î‡∏µ‡∏à‡∏±‡∏î‡∏™‡∏π‡∏î‡πÜ‡πÜ‡πÜ.pt",
    "violence-pose.pt"
]

def export_models():
    # ‡πÄ‡∏ä‡πá‡∏Ñ‡∏Å‡πà‡∏≠‡∏ô‡∏ß‡πà‡∏≤‡∏°‡∏µ GPU ‡πÑ‡∏´‡∏° ‡πÄ‡∏û‡∏£‡∏≤‡∏∞ TensorRT ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ GPU ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≠‡∏°‡πÑ‡∏û‡∏•‡πå
    if not torch.cuda.is_available():
        print("‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö GPU! ‡∏Å‡∏≤‡∏£ Export ‡πÄ‡∏õ‡πá‡∏ô TensorRT ‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ NVIDIA GPU ‡πÅ‡∏•‡∏∞ CUDA ‡∏Ñ‡∏£‡∏±‡∏ö")
        return

    for model_name in model_files:
        model_path = f"models/{model_name}"
        print(f"üì¶ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÅ‡∏õ‡∏•‡∏á‡πÇ‡∏°‡πÄ‡∏î‡∏•: {model_name}...")
        
        try:
            # ‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏°‡πÄ‡∏î‡∏• .pt
            model = YOLO(model_path)
            
            # ‡∏™‡∏±‡πà‡∏á Export ‡πÄ‡∏õ‡πá‡∏ô engine (TensorRT)
            # half=True ‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏£‡∏±‡∏ô‡∏ö‡∏ô FP16 ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏£‡πá‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡∏Å‡πÅ‡∏•‡∏∞‡∏Å‡∏¥‡∏ô VRAM ‡∏ô‡πâ‡∏≠‡∏¢‡∏•‡∏á
            model.export(format="engine", device=0, half=True)
            
            print(f"‚úÖ ‡πÅ‡∏õ‡∏•‡∏á {model_name} ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!")
        except Exception as e:
            print(f"‚ö†Ô∏è ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏Å‡∏±‡∏ö {model_name}: {e}")

    print("\nüöÄ ‡∏ó‡∏∏‡∏Å‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ñ‡∏π‡∏Å‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô .engine ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß (‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå models)")

if __name__ == "__main__":
    export_models()